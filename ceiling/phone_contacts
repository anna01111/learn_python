import pickle
# Any object in Python can be pickled so that it can be saved on disk.
# Pickling is a way to convert a python object (list, dict, etc.) into a character stream.
# This character stream contains all the information necessary to reconstruct the object in another python script.

# contact looks like [name, surname, age, phone number]
# contacts = [['anna', 'lozynska', 28, '0930000000']]


contacts = []
FILENAME = "users.dat"


def show_contacts():
    for el in contacts:
        print(el)


def add_contact():
    name = input("Please enter name: ")
    surname = input("Please enter surname: ")
    while True:
        try:
            age = int(input("Please enter age: "))
            break
        except ValueError:
            print("Error - input must be a whole number. Please try again: ")

    phone_number = input("Please enter phone number: ")
    contacts.append([name, surname, age, phone_number])


def remove_contact():
    name = input('Please enter name: ')
    surname = input('Please enter surname: ')
    for i in range(len(contacts)):
        if contacts[i][0] == name and contacts[i][1] == surname:
            command = input('Do you really want to delete user {}? y/n '.format(contacts[i]))
            if command == 'y':
                x = contacts[i]
                contacts.remove(x)
                print('User has been removed.')
                break
            else:
                continue
    else:
        print('User not found')


def edit_contact():
    name = input('Please enter name of the contact you want to edit: ')
    surname = input('Please enter surname of the contact you want to edit: ')
    for i in range(len(contacts)):
        if contacts[i][0] == name and contacts[i][1] == surname:
            command = input('Do you want to edit user {}? y/n '.format(contacts[i]))
            if command == 'y':
                menu_edit(i)
                print(f'{contacts[i]} has been edited.')
                break
            else:
                continue
    else:
        print('User not found')


def save_to_a_file():
    with open(FILENAME, 'wb') as file:
        pickle.dump(contacts, file)


def load_from_file():
    with open(FILENAME, 'rb') as file:
        contacts1 = pickle.load(file)
        return contacts1


def sort_by_name():
    contacts.sort()


def menu():
    action = ''
    while action != 'q':
        print('Welcome to contact list')
        action = input('Please enter s to show contacts, a to add a contact, sr to sort, r to remove, e to edit, q to exit: ')
        if action == 's':
            show_contacts()
        if action == 'a':
            add_contact()
        if action == 'sr':
            sort_by_name()
        if action == 'r':
            remove_contact()
        if action == 'e':
            edit_contact()
        if action == 'q':
            save_to_a_file()
            print('Bye')


def menu_edit(index):
    action = ''
    while action != 'q':
        action = input('Please enter n to edit name, s to edit surname, a edit age, nm to edit number, q to exit: ')
        if action == 'n':
            name = input("Please enter new name: ")
            contacts[index][0] = name
        if action == 's':
            surname = input("Please enter new surname: ")
            contacts[index][1] = surname
        if action == 'a':
            while True:
                try:
                    age = int(input("Please enter new age: "))
                    break
                except ValueError:
                    print("Error - input must be a whole number. Please try again: ")
            contacts[index][2] = age
        if action == 'nm':
            phone_number = input("Please enter new phone number: ")
            contacts[index][3] = phone_number
        if action == 'q':
            print('End of editing.')


contacts = load_from_file()
menu()


